(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["VipPay"],{"16bc":function(t,i,e){"use strict";e.d(i,"b",function(){return s}),e.d(i,"c",function(){return a}),e.d(i,"g",function(){return c}),e.d(i,"h",function(){return r}),e.d(i,"e",function(){return o}),e.d(i,"f",function(){return u}),e.d(i,"d",function(){return p}),e.d(i,"i",function(){return l}),e.d(i,"j",function(){return d}),e.d(i,"l",function(){return _}),e.d(i,"m",function(){return v}),e.d(i,"n",function(){return f}),e.d(i,"o",function(){return m}),e.d(i,"p",function(){return y}),e.d(i,"q",function(){return h}),e.d(i,"r",function(){return g}),e.d(i,"s",function(){return b}),e.d(i,"t",function(){return P}),e.d(i,"u",function(){return C}),e.d(i,"a",function(){return A}),e.d(i,"v",function(){return x}),e.d(i,"k",function(){return w}),e.d(i,"w",function(){return k}),e.d(i,"x",function(){return E});var n=function(t){return"https://img.ddimg.mobi/assets/h5/".concat(t)},s=n("4602b1a87656d1501819113290.png"),a=n("9c3a30349e68a1498706936110.png"),c=n("activity-bill-first-head-log.png"),r=n("activity-bill-first-middle.png"),o=n("activity-bill-first-right-font2.png"),u=n("activity-bill-first-right-font1.png"),p=n("activity-bill-first-bottom.png"),l=n("activity-bill-pack-foot-logo.png"),d=n("activity-bill-share-small-img.png"),_=n("newtask/icon-buy.png"),v=n("newtask/icon-day.png"),f=n("newtask/icon-evaluate.png"),m=n("newtask/icon-fish.png"),y=n("newtask/icon-info.png"),h=n("newtask/icon-invite.png"),g=n("newtask/icon-meat.png"),b=n("newtask/icon-sign.png"),P=n("newtask/icon-vip.png"),C=n("newtask/logo-bottom.png"),A=n("44b2872a591fe1503888813415.png"),x=n("receive-cart-tip.png?v=1"),w=n("give-cart-title.png?v=1"),k=n("vip/member-0.png"),E=n("vip/member-1.png")},"731e":function(t,i,e){},bde3:function(t,i,e){"use strict";e("aba3");var n=e("f708"),s=e("b893");i["a"]={methods:{visibilityAppShow:function(t){if(n["a"].isApp){var i=Object(s["b"])(n["a"].appVersion,"8.29.1")<=0,e=0;this.eventListenerApp("APP_E5",function(){n["a"].isIos&&i?(e++,2===e&&(e=0,t&&t())):t&&t()}),n["a"].isIos&&this.eventListenerApp("APP_E1",function(){t&&t()})}},visibilityWebChange:function(t){var i="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,e=i.replace(/hidden/i,"visibilitychange");document.addEventListener(e,function(){document[i]?t&&t(!1):t&&t(!0)})}}}},c2b3:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"vip-pay-wrapper"},[e("div",{staticClass:"vip-user-info"},[e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t.user_info.avatar||t.DEFAULT_USER_AVATAR_NEW,alt:""}})]),e("div",{staticClass:"text-wrap"},[e("div",{staticClass:"name"},[t._v("\n                "+t._s(t.user_info.name)+"\n                "),2===t.status?e("img",{staticClass:"member",attrs:{src:t.MEMBER_0,alt:""}}):t._e(),1===t.status?e("img",{staticClass:"member",attrs:{src:t.MEMBER_1,alt:""}}):t._e()]),0===t.status?e("div",{staticClass:"status"},[t._v("绿卡未开通")]):t._e(),1===t.status?e("div",{staticClass:"status"},[t._v(t._s(t.expire_time)+"到期")]):t._e(),2===t.status?e("div",{staticClass:"status"},[t._v("已到期")]):t._e()])]),e("div",{staticClass:"vip-body"},[0===t.status?e("div",{staticClass:"vip-privilege"},[e("div",{staticClass:"title"},[t._v("开通绿卡享三大权益，预计每单省6.96元")]),e("div",{staticClass:"privilege-list"},[e("div",{staticClass:"privilege-item"},[e("icon-font",{attrs:{name:"zhuanxiangquanx",size:"66",color:"#97DFB5"}}),e("div",{staticClass:"name"},[t._v("专享券")])],1),e("div",{staticClass:"privilege-item"},[e("icon-font",{attrs:{name:"zhuanxiangtejiax1",size:"66",color:"#97DFB5"}}),e("div",{staticClass:"name"},[t._v("专享特价")])],1),e("div",{staticClass:"privilege-item"},[e("icon-font",{attrs:{name:"beijifenx1",size:"66",color:"#97DFB5"}}),e("div",{staticClass:"name"},[t._v(t._s(t.vip_point_rate)+"倍积分")])],1)])]):t._e(),1===t.status?e("div",{staticClass:"vip-save-text"},[t.save_money>=t.minimum_price?e("div",{staticClass:"title"},[t._v("绿卡权益已为您节省"+t._s(t.save_money)+"元")]):t._e(),t.save_money<t.minimum_price?e("div",{staticClass:"title"},[t._v("立即续卡预计每单省6.96元")]):t._e()]):t._e(),2===t.status?e("div",{staticClass:"vip-save-text"},[t.save_money>=t.minimum_price?e("div",{staticClass:"title"},[t._v("绿卡权益已为您节省"+t._s(t.save_money)+"元")]):t._e(),t.save_money<t.minimum_price?e("div",{staticClass:"title"},[t._v("开通绿卡，预计每单省6.96元")]):t._e()]):t._e(),e("div",{ref:"listWrap",staticClass:"vip-pay-cards"},[e("div",{staticClass:"price-list",style:t.listStyle},t._l(t.cards,function(i,n){return e("div",{key:i.id,staticClass:"price-list-item",class:{selected:t.select_index===n},on:{click:function(i){t.selectCard(n)}}},[i.discount<10?e("div",{staticClass:"discount"},[t._v(t._s(i.discount)+"折")]):t._e(),e("div",{staticClass:"name"},[t._v(t._s(i.name)+"·"+t._s(i.days)+"天")]),e("div",{staticClass:"desc"},[t._v(t._s(i.description))]),e("div",{staticClass:"price-wrap"},[e("div",{staticClass:"price"},[e("span",[t._v("￥")]),t._v(t._s(i.price)+"\n                        ")]),i.price<i.origin_price?e("div",{staticClass:"origin-price"},[e("s",[t._v("￥"+t._s(i.origin_price))])]):t._e()]),e("div",{staticClass:"check-wrap"},[t.select_index!==n?e("i",{staticClass:"icon-circle"}):t._e(),t.select_index===n?e("i",{staticClass:"icon-checked"},[e("icon-font",{attrs:{name:"chenggong",size:"20",color:"#fff"}})],1):t._e()])])}))]),e("div",{staticClass:"vip-rights-desc",on:{click:t.gotoVipRightDesc}},[e("span",[t._v("叮咚绿卡会员权益说明")]),e("icon-font",{attrs:{name:"shuomingx",size:"26",color:"#999999"}})],1)]),e("div",{staticClass:"vip-pay-type m-top20"},[e("div",{staticClass:"title"},[t._v("支付方式")]),e("div",[e("div",{staticClass:"pay-type",on:{click:function(i){t.selectPayment(t.PAY_TYPE.ALI_APP)}}},[e("icon-font",{staticClass:"icon-ali",attrs:{name:"Shapex",size:"30",color:"#07A0F8"}}),e("span",[t._v("支付宝支付")]),e("div",{staticClass:"check-wrap"},[t.pay_type!==t.PAY_TYPE.ALI_APP?e("i",{staticClass:"icon-circle"}):t._e(),t.pay_type===t.PAY_TYPE.ALI_APP?e("i",{staticClass:"icon-checked"},[e("icon-font",{attrs:{name:"chenggong",size:"20",color:"#fff"}})],1):t._e()])],1),e("div",{staticClass:"pay-type",on:{click:function(i){t.selectPayment(t.PAY_TYPE.WEIXIN_APP)}}},[e("icon-font",{staticClass:"icon-wx",attrs:{name:"Shapex1",size:"30",color:"#00B700"}}),e("span",[t._v("微信支付")]),e("div",{staticClass:"check-wrap"},[t.pay_type!==t.PAY_TYPE.WEIXIN_APP?e("i",{staticClass:"icon-circle"}):t._e(),t.pay_type===t.PAY_TYPE.WEIXIN_APP?e("i",{staticClass:"icon-checked"},[e("icon-font",{attrs:{name:"chenggong",size:"20",color:"#fff"}})],1):t._e()])],1)])]),e("div",{staticClass:"vip-pay-btn",on:{click:t.eventCreateOrder}},[e("span",[t._v("立即支付")])])])},s=[],a=e("059d"),c=e.n(a),r=(e("cf54"),e("25d7"),e("5475"),e("4aee")),o={ALI_APP:2,WEIXIN_MP:3,WEIXIN_APP:4},u=e("b12f"),p=e("113c");function l(t){return l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function d(t){return d="function"===typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)},d(t)}var _=e("f708"),v=e("823b"),f=e("eba3"),m=e("afaa"),y=e("7c07"),h=3e4,g="/vip/payResult",b=function(){return{redirect_url:"".concat(location.origin,"/?channel=").concat(v["a"].defaultChannel,"#").concat(g,"?"),home_url:"".concat(location.origin,"/#").concat(g,"?"),param_split:"&"}},P=function(t,i){var e=setTimeout(function(){i&&i()},h);return function(n){clearTimeout(e),_["a"].isAndroid&&(n.success?t&&t(n):i&&i(n)),_["a"].isIos&&("success"in n?n.success?t&&t(n):i&&i(n):/(resultStatus=\{9000})|("ResultStatus":"9000")/.test(n.result)?t&&t(n):i&&i(n))}},C=function(t,i){var e=setTimeout(function(){i&&i()},h);return function(n){clearTimeout(e),_["a"].isAndroid&&(n.success?t&&t(n):i&&i(n)),_["a"].isIos&&("object"===d(n)&&(n=JSON.stringify(n)),n.indexOf("ret=0")>-1?t&&t(n):i&&i(n))}},A=function(t){if(_["a"].isApp){var i=t.type,e=t.pay_url,n=t.success,s=t.error;i===o.ALI_APP&&f["a"].aliPay({pay_url:e,callback:P(n,s),error:s}),i===o.WEIXIN_APP&&f["a"].weixinPay({pay_url:e,callback:C(n,s),error:s})}else m["a"].postForm("".concat(y["a"].PAY,"pay/wx.php"),Object(p["a"])({},b(),t))},x={pay:A},w=e("5d2d"),k=e("bde3"),E=e("16bc"),I={name:"VipPay",mixins:[k["a"]],data:function(){return{status:0,user_status:1,cards:[],pay_type:o.ALI_APP,select_index:0,renew_remain:0,save_money:"",PAY_TYPE:o,DEFAULT_USER_AVATAR_NEW:E["a"],MEMBER_0:E["w"],MEMBER_1:E["x"],expire_time:"",vip_point_rate:2,buy_notice:"",order_number:""}},computed:{minimum_price:function(){var t=this.cards||[];return t.length?t[t.length-1].price:0},listStyle:function(){return{width:Math.ceil(this.covertPx(286*this.cards.length))+1+"px"}}},mounted:function(){var t=this.$route.query.invite_code;this.invite_code=t||"",this.user_login&&this.getCards(),this.setApp()},methods:{getCards:function(){var t=Object(r["a"])(c.a.mark(function t(){var i,e,n,s,a,r,o,p,l,d,_,v=this;return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.get(u["a"].vipApi("card"));case 2:i=t.sent,e=i.data,e&&(n=e.status,s=e.user_status,a=e.cards,r=e.renew_remain,o=e.save_money,p=e.expire_time,l=e.vip_point_rate,d=e.buy_notice,this.log({cid:"open_vip",aid:"index",index:1===n}),_=a.reverse(),_.forEach(function(t,i){t.is_activity=t.price!==t.origin_price,"年卡"===t.name&&(v.select_index=i)}),this.status=n,this.user_status=s,this.cards=_,this.renew_remain=r,this.save_money=o,this.expire_time=p,this.vip_point_rate=l||2,this.buy_notice=d);case 5:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),eventCreateOrder:function(){var t=this;_["a"].isApp?this.buy_notice?this.$confirm({content:t.buy_notice,submitText:"继续支付",success:function(){t.createOrder()}}):this.createOrder():this.$toast("请前往APP购买")},createOrder:function(){var t=Object(r["a"])(c.a.mark(function t(){var i,e,n,s,a,r,o,p,l=this;return c.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=this.invite_code,this.order_number="",this.log({cid:"open_vip",aid:"pay_now"}),e=this.cards[this.select_index].id,t.next=6,this.$http.get(u["a"].vipApi("buy"),{card_id:e,pay_type:this.pay_type,invite_code:i},!1);case 6:n=t.sent,s=n.data,s&&(this.$store.state.loading.isLoading=!0,a=s.pay_url,r=s.order_number,o=s.user_status,w["a"].save("VIP_PAYING",{paying:!0,order_number:r}),this.order_number=r,p=function(){var t=w["a"].load("VIP_PAYING");t.paying&&(w["a"].update("VIP_PAYING",{paying:!1}),l.openUrl({path:"/vip/payResult",query:{user_status:o,invite_code:i}}))},x.pay({type:this.pay_type,pay_url:a,order_number:r,success:p,error:p}));case 9:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),selectCard:function(t){this.select_index=t},gotoVipRightDesc:function(){this.openUrl({path:"https://maicai.api.ddxq.mobi/info/single?alias=green_card_protocol"})},selectPayment:function(t){this.pay_type=t},setApp:function(){var t=this;if(_["a"].isApp){var i=this.$route.query.back_app;setTimeout(function(){f["a"].setNavigationBarStyle({style:1,bar_color:"#2E3748"})},200),i&&this.eventListenerApp("APP_E6",function(){t.openUrl({path:"/vip",query:{back_app:1}})},!0),this.visibilityAppShow(function(){var i=t,e=w["a"].load("VIP_PAYING");e.paying&&setTimeout(function(){var t=w["a"].load("VIP_PAYING");t.paying&&(w["a"].update("VIP_PAYING",{paying:!1}),i.openUrl({path:"/vip/payResult",query:{user_status:i.user_status,invite_code:i.invite_code}}))},3e3)})}},covertPx:function(t){var i=document.documentElement.clientWidth||750;return t*i/750}},watch:{user_login:function(){this.user_login&&this.getCards()},select_index:function(){var t=this,i=286,e=750,n=this.select_index*i-e/2+i/2;this.$nextTick(function(){t.$refs.listWrap.scrollLeft=t.covertPx(n)})}}},S=I,Y=(e("ee8e"),e("17cc")),T=Object(Y["a"])(S,n,s,!1,null,"df4fcc82",null);i["default"]=T.exports},ee8e:function(t,i,e){"use strict";var n=e("731e"),s=e.n(n);s.a}}]);
//# sourceMappingURL=VipPay.a5a607a1.js.map